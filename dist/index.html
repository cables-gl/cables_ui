<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no" />

    <title>cables</title>
    <link rel="stylesheet" type="text/css" href="css/ui.css">
</head>
<body>

    <canvas id="glcanvas" width="640" height="360"></canvas>

    <script type="text/javascript" src="js/libs.js"></script>
    <script type="text/javascript" src="js/cables.max.js"></script> 
    <script type="text/javascript" src="js/cables.ops.max.js"></script> 
    <script type="text/javascript" src="js/cablesui.max.js"></script> 

<script id="entry-template" type="text/x-handlebars-template">
  <div class="entry">
    <h1>{{title}}</h1>
    <div class="body">
      {{body}}
    </div>
  </div>
</script>


<div id="modalbg"></div>
<div id="modalcontent"></div>


<div id="sidebar" class="hidden ">
    <div class="content">
        <a  class="button_toggleSidebar button">close</a>
        <br/>
        <br/>
        <a class="button_saveLocalStorage" >save local storage</a>
        <br/>
        <a class="button_loadLocalStorage" >load local storage</a>

        <hr/>

        <a class="button_export" >export</a>
        <br/>
        <a class="button_import" >import</a>
        <br/>
        <br/>
        <a class="button button_clearPatch" >clear patch</a>
        <br/>
        <br/>
        <span class="button" onclick="gui.createProject();">create project</span>
        <br/>
        <br/>
        <span class="button" onclick="CABLES.UI.SELECTPROJECT.show();">open projects</span>


    </div>
</div>

<div id="button_subPatchBack" class="hidden"><i class="fa  fa-3x fa-arrow-circle-o-left"></i></div>

<div id="patch" tabindex="1"></div>

<div id="timing"></div>
<div id="statusbar"></div>
<!-- <div id="splitter"></div> -->


<div id="meta">

    <div id="projectfiles">
    </div>
</div>
<div id="options" class="panel"></div>

<div id="menubar">

    <a class="button_toggleSidebar button">cables</a>

    <a class="button_addOp button fa fa-plus-square-o tt" data-tt="create new op"></a>

    <a id="button_cycleRenderSize" class="button fa fa-expand tt"  data-tt="resize webgl renderer (esc to exit fullscreen)"></a>

    <div id="serverproject" style="float:left;display:none;">
        <a  class="button_saveCurrentProject button">save project <span id="serverprojectname"></span></a>
    </div>

    <a target="_blankk" class="viewProjectLink button fa fa-external-link"></a>

    <div id="loggedin">
        <div id="username"></div> <a class="button tt" href="/logout" data-tt="logout">logout</a>
    </div>

    <div id="loggedout">
        <div id="username">not logged in</div> <a class="button fa fa-sign-out" href="/"></a>
    </div>

</div>

<div class="tooltip"></div>


<script id="op_select" type="text/x-handlebars-template">
    
<div class="opsearch">
    <h2>selct op</h2>

    <input id="opsearch"/>

    <br/><br/>
    <style id="search_style"></style>


    <div style="height:300px;overflow:auto">
      {{#each ops}}

        <div class="searchresult searchable" data-opname="{{ name }}" data-index="{{lowercasename}}">
            <a onclick="gui.scene().addOp('{{name}}');CABLES.UI.MODAL.hide();" >{{name}}  {{isFunction}}</a>
        </div>

      {{/each}}
    </div>

</div>

</script>



<script id="params_op_head" type="text/x-handlebars-template">

    <div class="">
        <input class="medium" id="opname" oninput="gui.patch().setCurrentOpTitle($('#opname').val());" value="{{op.name}}">
        <br/><br/>{{op.objName}}
        
        <br/>
        <br/>
    </div>

<table>

</script>


<script id="params_op_foot" type="text/x-handlebars-template">

</table>

<div>
{{{ json op.uiAttribs }}}
</div>

<div>
    <br/>
    <br/>
    <span class="button warn" onclick="if(confirm('delete ?'))gui.scene().deleteOp('{{op.id}}')">delete</span>
    <br/>
    <br/>
</div>

<script>



    $("input").keydown(function(e)
    {
        switch(e.which)
        {
            case 38: // up
                this.value=CABLES.UI.inputIncrement(this.value,1);
                $(this).trigger('input');
                return false;
            break;

            case 40: // down
                this.value=CABLES.UI.inputIncrement(this.value,-1);
                $(this).trigger('input');
                return false;
            break;

            default: return; // exit this handler for other keys
        }
        e.preventDefault(); // prevent the default action (scroll / move caret)
    });

    $("input").bind("mousewheel", function(event, delta) 
    {
        if (delta > 0)
        {
            this.value = Math.round(1000*CABLES.UI.inputIncrement(this.value,1))/1000;
        }
        else
        {
            this.value = Math.round(1000*CABLES.UI.inputIncrement(this.value,-1))/1000;
        }

         $(this).trigger('input');
        return false;
     });
</script>

</script>



<script id="params_ports_head" type="text/x-handlebars-template">
    
<tr>
<th colspan="11">
<div class="panelhead">{{title}}:</div>
</th>
</tr>

</script>

<script id="params_port" type="text/x-handlebars-template">


<tr id="tr_{{ dirStr }}_{{ portnum }}">
    <td class="port portType_{{ port.type }}">
        {{port.name}}
    </td>
    <td>
        {{#compare port.uiAttribs.colorPick '==' 'true' }}
        <div class="button_colorpick button fa fa-eyedropper" id="watchcolorpick_{{ dirStr }}_{{ portnum }}"></div>
        {{/compare}}
    </td>
    <td class="">
        {{#if isInput}}

            {{#if port.links}}
                {{#compare port.type '==' '1' }}function{{/compare}}
                {{#compare port.type '==' 0 }} <span class="value watchPortValue_{{ port.watchId }}">{{port.val}}</span>{{/compare}}
                {{#compare port.type '==' '2' }} object {{/compare}}
            {{else}}
                {{#if port.uiAttribs.display}}

                    {{#compare port.uiAttribs.display '==' 'bool' }}
                        
                        <span id="portcheckbox_{{ portnum }}" class="button fa fa-square-o" onclick="CABLES.UI.togglePortValBool('portval_{{ portnum }}','portcheckbox_{{ portnum }}');" style="padding-left:10px;padding-right:10px;"></span>
                        <input class="value" id="portval_{{ portnum }}" value="{{ port.val }}" style="width:70px;display:inline;"/>

                    {{/compare}}
                    {{#compare port.uiAttribs.display '==' 'range' }}

                        <a class="timingbutton fa fa-clock-o" id="portanim_{{ dirStr }}_{{ portnum }}" ></a>
                        <a class="graphbutton fa fa-line-chart" id="portgraph_{{ dirStr }}_{{ portnum }}" ></a>
                        <input type ="range" class="range" min ="0" max="1.0" value="{{ port.val }}" step ="0.001" oninput="$('#portval_{{ portnum }}').val(this.value);$('#portval_{{ portnum }}').trigger('input');" style="width:90px;"/>
                        <input class="value watchPortValue_{{ port.watchId }}" id="portval_{{ portnum }}" value="{{ port.val }}" style="width:40px;display:inline;"/>

                    {{/compare}}
                    {{#compare port.uiAttribs.display '==' 'dropdown' }}
                        
                        <select oninput="$('#portval_{{ portnum }}').val(this.value);$('#portval_{{ portnum }}').trigger('input');">
                            <option value="">...</option>
                            {{#each port.uiAttribs.values}}
                                <option value="{{ this }}">{{ this }}</option>
                            {{/each}}
                        </select>
                        <input class="value" id="portval_{{ portnum }}" value="{{ port.val }}" style="width:70px;display:inline;"/>
                    {{/compare}}
                    {{#compare port.uiAttribs.display '==' 'readonly' }}
                        {{ port.val }}
                    {{/compare}}

                {{else}}
                
                    {{#compare port.type '==' '1' }} function
                    {{/compare}}{{#compare port.type '==' 0 }}

                    <a class="timingbutton fa fa-clock-o" id="portanim_{{ dirStr }}_{{ portnum }}" ></a>
                    <a class="graphbutton fa fa-line-chart" id="portgraph_{{ dirStr }}_{{ portnum }}" ></a>
                    
                    <input class="value watchPortValue_{{ port.watchId }}" id="portval_{{ portnum }}" value="{{ port.val }}"/>

                    {{/compare}}
                    {{#compare port.type '==' '2' }} object {{/compare}}
                
                {{/if}}
            {{/if}}

        {{else}}

            {{#compare port.type '==' '1' }}function{{/compare}}
            {{#compare port.type '==' 0 }} <span class="value watchPortValue_{{ port.watchId }}" >{{port.val}}</span> {{/compare}}
            {{#compare port.type '==' '2' }} object {{/compare}}

            
        {{/if}}
    </td>


    <td>

        {{#if port.links}}
            <a class="button fa fa-chain-broken" id="portdelete_{{ dirStr }}_{{ portnum }}" ></a>
            {{port.links.length}}x
        {{/if}}
    </td>
</tr>

</script>



<script id="params_project" type="text/x-handlebars-template">


    <div class="">
        <input class="medium" id="projectsettings_name" oninput="gui.patch().saveProjectParams();" value="{{project.name}}">

        <br/>
        <br/>

    </div>
        <table>
            <tr>
                <th colspan="11">
                    <div class="panelhead">project settings</div>
                </th>
            </tr>
            <tr onclick="togglePublic();">
            <td></td>
                <td>
                    &nbsp;public
                    <input type="hidden" id="projectsettings_public" value="{{ project.settings.isPublic }}"></input>
                </td>
                <td>
                    <a id="projectsettings_public_icon" class="button fa fa-square-o"></a>
                </td>
            </tr>

        </table>

        <br/>
        <br/>

    <div class="">
        <a onclick="gui.patch().saveCurrentProject();" class="button">save settings</a>


<br/>
<br/>
<br/>
{{project.id}}
    <span class="button fa fa-trash-o tt" data-tt="delete" onclick="gui.deleteCurrentProject();"></a>

    </div>


<script>

function updateIcons()
{
    if($('#projectsettings_public').val()=='true')
    {
        $('#projectsettings_public_icon').addClass('fa-check-square-o');
        $('#projectsettings_public_icon').removeClass('fa-square-o');
    }
    else
    {
        $('#projectsettings_public_icon').removeClass('fa-check-square-o');
        $('#projectsettings_public_icon').addClass('fa-square-o');
    }
    gui.patch().saveProjectParams();
}

function togglePublic()
{
    $('#projectsettings_public').val(''+!($('#projectsettings_public').val()=='true')); 

    updateIcons();
}

updateIcons();



</script>


</script>


<script id="tmpl_projectfiles_list" type="text/x-handlebars-template">
    <h2>files</h2>

    <table class="list">
        {{#each files}}
            <tr>
            <!--
            <td>
                <a class="button fa fa-info-circle" onclick="gui.patch().showFileInfo*()"></a> 
            </td>-->
            <td>
                <a class="filename" onclick="gui.patch().addAssetOp('/assets/{{projectId}}/{{_id}}{{suffix}}','{{suffix}}','{{name}}')">
                {{name}}
                </a>
            </td>
            <td>
                <a class="button fa fa-trash-o" onclick="CABLES.api.delete('project/{{projectId}}/file/{{_id}}',null,function(){gui.patch().updateProjectFiles();});"></a>&nbsp;

                <!-- <a class="button fa fa-retweet"></a> -->
            </td>
            </tr>
        {{/each}}
    </table>
</script>


<script id="tmpl_projectfiles_upload" type="text/x-handlebars-template">
    <br/>
    <a class="fa fa-upload"></a>
    drag & drop files to browser window to upload...
</script>





<script id="select_project" type="text/x-handlebars-template">

<style>

.thumbcont .title
{
    background-color:black;
    padding:10px;

}

.searchresult
{
    width:180px;
    height:130px;
    float:left;
    cursor:pointer;
}

.thumbcont
{
    border:none !important;
}

.searchresult img
{
    max-width:180px;
    max-height:100px;
}

</style>

    
<div class="opsearch" style="height:auto;">
    <h2>selct project</h2>

    <input id="projectsearch"/>

    <br/><br/>
    <style id="search_style"></style>


    <div style="height:600px;overflow:auto">
      {{#each projects}}


        <div class="thumbcont searchresult searchable" data-projid="{{ _id }}" data-index="{{name}}" onclick="document.location.href='#/project/{{_id}}'">
            <img src="/assets/{{_id}}/screenshot.png" style="width:180px;"/>
            <div class="title">
                {{name}}
            </div>
        </div>

      {{/each}}
    </div>

</div>

</script>



<script id="timeline_controler" type="text/x-handlebars-template">

    <div id="timelineui">
        <a id="button_toggleTiming" class="button">timing</a>

        <span class="timelinetime" onclick="gui.timeLine().toggleTimeDisplayMode();"></span>
        <span class="button timeLineInsert fa fa-plus-square-o"></span>

        <a class="button fa fa-step-backward" onclick="gui.scene().timer.setTime(0);"></a>
        <a class="button fa fa-backward" onclick="gui.scene().timer.setOffset(-2);"></a>
        <a class="button fa fa-play " id="timelineplay" onclick="gui.timeLine().togglePlay()"></a>
        <a class="button fa fa-forward" onclick="gui.scene().timer.setOffset(2);"></a>

        <input type ="range" min="20" max="2000" value="" step ="1" oninput="gui.timeLine().setTimeScale(this.value);" style="float:left;width:85px;margin-left:20px;margin-top:10px;" class="tt" data-tt="scale time display"/>


        <a id="keymovemode" class="button fa fa-arrows tt" data-tt="key move mode" ></a>
        <a id="keyscaleheight" class="button fa fa-ellipsis-v tt" data-tt="scale value display"></a>
        <a id="keyscalewidth" class="button fa fa-ellipsis-h tt" data-tt="show all keys"></a>

        <a id="centercursor" class="button fa fa-i-cursor tt" data-tt="scroll to cursor"></a>

        <a id="loop" class="button fa fa-retweet tt" data-tt="toggle loop"></a>


<a onclick="$('.easingselect').toggle();" class="button">ease</a>



<div class="" style="float:right">
    <div class="hidden easingselect" >

<div class="select">
    <h3>in_out</h3>
    <a onclick="gui.timeLine().setSelectedKeysEasing(CABLES.TL.EASING_SIN_INOUT);">sin</a><br/>
    <a onclick="gui.timeLine().setSelectedKeysEasing(CABLES.TL.EASING_CUBIC_INOUT);">cubic</a><br/>
    <a onclick="gui.timeLine().setSelectedKeysEasing(CABLES.TL.EASING_EXPO_INOUT);">expo</a><br/>
    <br/>

    <a onclick="gui.timeLine().setSelectedKeysEasing(CABLES.TL.EASING_LINEAR);">linear</a><br/>
    <a onclick="gui.timeLine().setSelectedKeysEasing(CABLES.TL.EASING_ABSOLUTE);">absolute</a><br/>
    <a onclick="gui.timeLine().setSelectedKeysEasing(CABLES.TL.EASING_SMOOTHSTEP);">smoothstep</a><br/>
    <a onclick="gui.timeLine().setSelectedKeysEasing(CABLES.TL.EASING_SMOOTHERSTEP);">smootherstep</a><br/>
    <a onclick="gui.timeLine().setSelectedKeysEasing(CABLES.TL.EASING_BEZIER);">bezier</a><br/>
</div>

<div class="select">
    <h3>in</h3>
    <a onclick="gui.timeLine().setSelectedKeysEasing(CABLES.TL.EASING_SIN_IN);">sin</a><br/>
    <a onclick="gui.timeLine().setSelectedKeysEasing(CABLES.TL.EASING_CUBIC_IN);">cubic</a><br/>
    <a onclick="gui.timeLine().setSelectedKeysEasing(CABLES.TL.EASING_EXPO_IN);">expo</a><br/>
</div>

<div class="select">
    <h3>out</h3>
    <a onclick="gui.timeLine().setSelectedKeysEasing(CABLES.TL.EASING_SIN_OUT);">sin</a><br/>
    <a onclick="gui.timeLine().setSelectedKeysEasing(CABLES.TL.EASING_CUBIC_OUT);">cubic</a><br/>
    <a onclick="gui.timeLine().setSelectedKeysEasing(CABLES.TL.EASING_EXPO_OUT);">expo</a><br/>
</div>




<!--
        // <a id="ease_linear" class="button tt" data-tt="easing: linear">lin</a>
        // <a id="ease_absolute" class="button tt" data-tt="easing: absolute">abs</a>
        // <a id="ease_smoothstep" class="button tt" data-tt="easing: smoothstep">smo</a>
        // <a id="ease_smootherstep" class="button tt" data-tt="easing: smootherstep">smo2</a>
        // <a id="ease_bezier" class="button tt" data-tt="easing: smootherstep">bez</a>
        -->
    </div>
</div>





    </div>

    <div id="timelineTitle" ></div>
    <div id="timetimeline" ></div>
    <div id="timeline" tabindex="2"></div>



</script>


        <a id="undev" target="_blank" href="http://www.undev.de"></a>

    </body>
</html>
