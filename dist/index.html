<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no" />

    <title>cables</title>
    <link rel="stylesheet" type="text/css" href="css/ui.css">
</head>
<body>

    <canvas id="glcanvas" width="640" height="360"></canvas>

    <script type="text/javascript" src="js/libs.ui.min.js"></script>
    <script type="text/javascript" src="js/libs.core.min.js"></script>
    <script type="text/javascript" src="js/cables.max.js"></script> 
    <script type="text/javascript" src="js/cables.ops.max.js"></script> 
    <script type="text/javascript" src="js/cablesui.max.js"></script> 
    <script type="text/javascript" src="js/ace/ace.js"></script> 



<script id="editor_bar" type="text/x-handlebars-template">


<div class="tabs">
    {{#each contents}}
    <div id="editortab{{id}}" class="tab" onclick="gui.editor().setTab('{{id}}')">{{title}}</div>
    {{/each}}
    <div style="clear:both;"></div>
</div>

<div class="iconbar">
    <a class="button" onclick="gui.editor().save()">save</a>


    <a style="margin-left:100px;" class="button" onclick="gui.editor().closeCurrentTab()">X</a>
</div>




</script>

<script id="entry-template" type="text/x-handlebars-template">
  <div class="entry">
    <h1>{{title}}</h1>
    <div class="body">
      {{body}}
    </div>
  </div>
</script>



<script id="library_head" type="text/x-handlebars-template">

    <div class="tabs">
        <div onclick="CABLES.UI.fileSelect.setTab('projectfiles');" id="tab_projectfiles" class=" tab">project files</div>
        <div onclick="CABLES.UI.fileSelect.setTab('library');" id="tab_library" class="tab">library</div>
    </div>

</script>


<script id="library_preview" type="text/x-handlebars-template">

    <div class="previewImage" style="border:4px solid #666;background-color:000;background-image:url('{{previewImageUrl}}');background-repeat:no-repeat;background-position:center center;background-size:100% auto;width:200px;height:200px;"></div>

    <div class="info"></div>

    <div>
        <br/><br/><br/>
        <a class="button" href="{{previewImageUrl}}" target="_blankk">open file</a>
    </div>

</script>


<script id="library_file" type="text/x-handlebars-template">

    <div class="file lvl{{file.l}} {{file.selectableClass}} type_{{file.t}}" 
    {{#compare filterType '==' 'image' }}
        style="float:left;width:120px;margin:5px;"{{/compare}}
        onclick="$('{{inputId}}').val('{{file.p}}');$('{{inputId}}').trigger('input');CABLES.UI.fileSelect.showPreview('{{file.p}}');"> 
        {{#compare filterType '==' 'image' }}
            <div class="lib_imgpreview" style="background-image:url({{file.p}});background-size:100% auto;width:120px;height:120px;background-position:center center;"></div>
        {{/compare}}
    {{file.n}} 
    ({{file.t}})
    </div>

</script>


<div id="library">
    <div class="left">
        <div id="lib_head"></div>
        <div id="lib_files"></div>
    </div>
    <div class="right">
        <div id="lib_preview"></div>
    </div>
</div>

<div id="modalbg"></div>
<div id="modalcontent"></div>





<div id="button_subPatchBack" class="hidden"><i class="fa  fa-3x fa-arrow-circle-o-left"></i></div>



<div id="editor" style="">
    <div id="editorbar"></div>
    <div id="ace" style="padding:0;height:300px;"></div>
</div>

<div id="patch" tabindex="1"></div>

<div id="timing"></div>
<div id="statusbar">
    <div class="text"></div>
</div>
<div id="splitterPatch" class="splitter"></div>
<div id="splitterRenderer" class="splitter"></div>
<div id="splitterRendererWH" class="splitter"></div>
<div id="splitterTimeline" class="splitter"></div>


<div id="meta">
    <div id="projectfiles"></div>
</div>

<div id="options" class="panel"></div>

<div id="menubar">

    <a class="button" href="/" target="_blankk">cables</a>

    <a id="button_openprojects" class="button fa fa-folder-open" onclick="CABLES.UI.SELECTPROJECT.show();"></a>

    <a class="button_addOp button fa fa-plus-square-o tt" data-tt="create new op"></a>


    <a id="help" href="/doc" target="_blankkk" class="button fa fa-question-circle"></a>

    <a id="button_settings" class="button fa fa-cog"></a>


<div id="assetsloadingindicator" style="display:none;float:left;margin-left:10px;padding-top:2px;"><i class="fa fa-2x fa-spinner fa-pulse"></i></div>



    <div id="" style="float:right;">
        <a target="_blankk" class="viewProjectLink button fa fa-external-link"></a>

        <a id="button_cycleRenderSize" class="button fa fa-expand tt"  data-tt="resize webgl renderer (esc to exit fullscreen)"></a>
        &nbsp;
        

    </div>


    <div id="serverproject" style="float:right;display:none;">
        <a  class="button_saveCurrentProject button">save project <span id="serverprojectname"></span></a>
    </div>

    <div id="loggedin">
        <div id="username"></div>
    </div>



    <div id="loggedout">
        <div id="username">not logged in</div> <a class="button fa fa-sign-out" href="/"></a>
    </div>




</div>


<div class="" style="float:right">
    <div class="hidden easingselect" >

<div>
    <span class="button icon-linear" onclick="gui.timeLine().setSelectedKeysEasing(CABLES.TL.EASING_LINEAR);"></span>
    <span class="button icon-absolut" onclick="gui.timeLine().setSelectedKeysEasing(CABLES.TL.EASING_ABSOLUTE);"></span>
    <span class="button icon-bezier" onclick="gui.timeLine().setSelectedKeysEasing(CABLES.TL.EASING_BEZIER);"></span>
<br/>
<br/>
</div>
<div>
    <span class="button icon-sin_in" onclick="gui.timeLine().setSelectedKeysEasing(CABLES.TL.EASING_SIN_IN);"></span>
    <span class="button icon-sin" onclick="gui.timeLine().setSelectedKeysEasing(CABLES.TL.EASING_SIN_INOUT);"></span>
    <span class="button icon-sin_out" onclick="gui.timeLine().setSelectedKeysEasing(CABLES.TL.EASING_SIN_OUT);"></span>
</div>
<div>
    <span class="button icon-cub_in" onclick="gui.timeLine().setSelectedKeysEasing(CABLES.TL.EASING_CUBIC_IN);"></span>
    <span class="button icon-cubic" onclick="gui.timeLine().setSelectedKeysEasing(CABLES.TL.EASING_CUBIC_INOUT);"></span>
    <span class="button icon-cub_out" onclick="gui.timeLine().setSelectedKeysEasing(CABLES.TL.EASING_CUBIC_OUT);"></span>
</div>

<div>
    <span class="button icon-exp_in" onclick="gui.timeLine().setSelectedKeysEasing(CABLES.TL.EASING_EXPO_IN);"></span>
    <span class="button icon-expo" onclick="gui.timeLine().setSelectedKeysEasing(CABLES.TL.EASING_EXPO_INOUT);"></span>
    <span class="button icon-exp_out" onclick="gui.timeLine().setSelectedKeysEasing(CABLES.TL.EASING_EXPO_OUT);"></span>
</div>



<!--
    <a onclick="gui.timeLine().setSelectedKeysEasing(CABLES.TL.EASING_SMOOTHSTEP);">smoothstep</a><br/>
    <a onclick="gui.timeLine().setSelectedKeysEasing(CABLES.TL.EASING_SMOOTHERSTEP);">smootherstep</a><br/>
    <a onclick="gui.timeLine().setSelectedKeysEasing(CABLES.TL.EASING_BEZIER);">bezier</a><br/>

-->

    </div>
</div>


<div class="tooltip"></div>


<script id="op_select" type="text/x-handlebars-template">
    
<div class="opsearch">
    <h2>selcet op</h2>

    <input id="opsearch"/>

    <br/><br/>
    <style id="search_style"></style>


    <div style="height:300px;overflow:auto" class="searchbrowser">
      {{#each ops}}

        <div class="searchresult searchable" data-opname="{{ name }}" data-index="{{lowercasename}}">
            <a onclick="gui.scene().addOp('{{name}}');CABLES.UI.MODAL.hide();" >{{name}}  {{isFunction}}</a>
        </div>

      {{/each}}
    </div>

    <div id="searchinfo" class="searchinfo"></div>

</div>

</script>



<script id="params_op_head" type="text/x-handlebars-template">

    <div class="">
        <input class="medium" id="opname" oninput="gui.patch().setCurrentOpTitle($('#opname').val());" value="{{op.name}}">
        <br/><br/>{{op.objName}}
        
        <br/>
        <br/>

        <div class="warning " id="options_warning" >
        {{op.uiAttribs.warning}}
        </div>

    </div>

<table>

</script>


<script id="params_op_foot" type="text/x-handlebars-template">

</table>



    <div class="info " id="options_info">
    {{{op.uiAttribs.info}}}
    </div>

<!--
<pre>
{{{ json op.uiAttribs }}}
</pre>

<div>
    <br/>
    <br/>
    <span class="button warn" onclick="if(confirm('delete ?'))gui.scene().deleteOp('{{op.id}}')">delete</span>
    <br/>
    <br/>
</div>
-->



<div id="doc_op" class="panel" style="padding:0px;"></div>

<script>

    gui.showOpDoc('{{{op.objName}}}');

    $("input").keydown(function(e)
    {
        switch(e.which)
        {
            case 38: // up
                this.value=CABLES.UI.inputIncrement(this.value,1);
                $(this).trigger('input');
                return false;
            break;

            case 40: // down
                this.value=CABLES.UI.inputIncrement(this.value,-1);
                $(this).trigger('input');
                return false;
            break;

            default: return; // exit this handler for other keys
        }
        e.preventDefault(); // prevent the default action (scroll / move caret)
    });

    $("input").bind("mousewheel", function(event, delta) 
    {
        if (delta > 0)
        {
            this.value = CABLES.UI.inputIncrement(this.value,1);
        }
        else
        {
            this.value = CABLES.UI.inputIncrement(this.value,-1);
        }

         $(this).trigger('input');
        return false;
     });
</script>

</script>



<script id="params_ports_head" type="text/x-handlebars-template">
    
<tr>
<th colspan="11">
<div class="panelhead">{{title}}:</div>
</th>
</tr>

</script>

<script id="params_port" type="text/x-handlebars-template">


<tr id="tr_{{ dirStr }}_{{ portnum }}">
    <td class="port portType_{{ port.type }}">
        {{port.name}}
    </td>
    <td>

        {{#compare port.uiAttribs.colorPick '==' 'true' }}
        <div class="button_colorpick button fa fa-eyedropper" id="watchcolorpick_{{ dirStr }}_{{ portnum }}"></div>
        {{/compare}}
    </td>
    <td class="">

        {{#if port.links}}



            {{#if port.direction }}
                {{#each port.links}}
                    <span class="paramsPortLink" onclick="gui.patch().setSelectedOpById('{{portIn.parent.id}}');"> [{{{portIn.name}}}]</span>
                {{/each}}
            {{else}}
                {{#each port.links}}
                    <span class="paramsPortLink" onclick="gui.patch().setSelectedOpById('{{portOut.parent.id}}');"> [{{{portOut.name}}}]</span>

                {{/each}}
            {{/if}}
        {{/if}}

        {{#if isInput}}

            {{#if port.links}}
                <!-- {{#compare port.type '==' '1' }}[function]{{/compare}} -->
                {{#compare port.type '==' 0 }} <span class="value valuetext watchPortValue_{{ port.watchId }}" >{{port.val}}</span>{{/compare}}
                {{#compare port.type '==' '2' }} 

                {{#if port.uiAttribs.preview}}
                    <a class="button fa fa-eye" onmouseover="CABLES.UI.showPreview('{{op.id}}','{{port.name}}',true);" onmouseout="CABLES.UI.showPreview('{{op.id}}','{{port.name}}',false);"></a>
                {{/if}}

                <!--[object]-->

                {{/compare}}
            {{else}}
                {{#if port.uiAttribs.display}}

                    {{#compare port.uiAttribs.display '==' 'bool' }}
                        <span id="portcheckbox_{{ portnum }}" class="graphbutton fa {{#compare port.val '==' true }}fa-check-square-o{{/compare}}{{#compare port.val '==' false }}fa-square-o{{/compare}}" onclick="CABLES.UI.togglePortValBool('portval_{{ portnum }}','portcheckbox_{{ portnum }}');" style="padding-left:5px;padding-right:30px;"></span>
                        <input class="value hidden" id="portval_{{ portnum }}" value="{{#if port.val }}true{{else}}false{{/if}}" style="display:none;"/>

                    {{/compare}}
                    {{#compare port.uiAttribs.display '==' 'range' }}

                        <a class="timingbutton fa fa-clock-o" id="portanim_{{ dirStr }}_{{ portnum }}" ></a>
                        <a class="graphbutton fa fa-line-chart" id="portgraph_{{ dirStr }}_{{ portnum }}" ></a>
                        <input type ="range" class="range" min ="0" max="1.0" value="{{ port.val }}" step ="0.001" oninput="$('#portval_{{ portnum }}').val(this.value);$('#portval_{{ portnum }}').trigger('input');" style="width:90px;"/>
                        <input class="value watchPortValue_{{ port.watchId }}" id="portval_{{ portnum }}" value="{{ port.val }}" style="width:40px;display:inline;"/>

                    {{/compare}}
                    {{#compare port.uiAttribs.display '==' 'dropdown' }}
                        
                        <select oninput="$('#portval_{{ portnum }}').val(this.value);$('#portval_{{ portnum }}').trigger('input');">
                            <option value="">...</option>
                            {{#each port.uiAttribs.values}}
                                <option value="{{ this }}">{{ this }}</option>
                            {{/each}}
                        </select>
                        <input class="value" id="portval_{{ portnum }}" value="{{ port.val }}" style="width:70px;display:inline;"/>
                    {{/compare}}
                    {{#compare port.uiAttribs.display '==' 'readonly' }}
                        {{ port.val }}
                    {{/compare}}

                    {{#compare port.uiAttribs.display '==' 'file' }}
                        
                        <a class="graphbutton timingbutton fa fa-folder-open-o" onclick="gui.showLibrary('.portFileVal_{{ portnum }}','{{port.uiAttribs.filter}}');" ></a>
                        <input class="value portFileVal_{{ portnum }} watchPortValue_{{ port.watchId }}" id="portval_{{ portnum }}" value="{{ port.val }}"/>

                    {{/compare}}


                {{else}}
                
                    {{#compare port.type '==' '1' }} [function]
                    {{/compare}}{{#compare port.type '==' 0 }}


                    <a class="timingbutton fa fa-clock-o" id="portanim_{{ dirStr }}_{{ portnum }}" ></a>
                    <a class="graphbutton fa fa-line-chart" id="portgraph_{{ dirStr }}_{{ portnum }}" ></a>
                    
                    <input class="value watchPortValue_{{ port.watchId }}" id="portval_{{ portnum }}" value="{{ port.val }}" />

                    <a class="graphbutton fa fa-sort" onmousedown="valueChanger('portval_{{ portnum }}');" style="margin-left:0px;height:17px;background-color:#383838"></a>

                    {{/compare}}
                    <!-- {{#compare port.type '==' '2' }} object {{/compare}} -->
                
                {{/if}}
            {{/if}}

        {{else}}

            <!-- {{#compare port.type '==' '1' }}[function]{{/compare}}-->
            {{#compare port.type '==' 0 }} <span class="value valuetext watchPortValue_{{ port.watchId }}" >{{port.val}}</span> {{/compare}}
            {{#compare port.type '==' '2' }}
                {{#if port.uiAttribs.preview}}
                    <a class="button fa fa-eye" onmouseover="CABLES.UI.showPreview('{{op.id}}','{{port.name}}',true);" onmouseout="CABLES.UI.showPreview('{{op.id}}','{{port.name}}',false);"></a>
                {{/if}}
                {{/compare}}
        {{/if}}
    </td>


    <td>

        {{#if port.links}}
            <a class="tt graphbutton fa fa-chain-broken" data-tt="unlink {{port.links.length}} links" id="portdelete_{{ dirStr }}_{{ portnum }}" ></a>
        {{/if}}
    </td>
</tr>

</script>



<script id="params_project" type="text/x-handlebars-template">


    <div class="">
        <input class="medium" id="projectsettings_name" onblur="gui.patch().saveProjectParams();" value="{{project.name}}">
        <br/>
        <br/>
    </div>
    <table>
        <tr>
            <th colspan="11">
                <div class="panelhead">project settings</div>
            </th>
        </tr>
        <tr onclick="togglePublic();">
        <td></td>
            <td>
                &nbsp;public
                <input type="hidden" id="projectsettings_public" value="{{ project.settings.isPublic }}"></input>
            </td>
            <td>
                <a id="projectsettings_public_icon" class="button fa fa-square-o"></a>
            </td>
        </tr>

    </table>

    <br/>




    <div id="projectdescription" class="panel" style="padding:0px;">
        <div class="panelhead">description</div>
        <div>
            {{{descr}}}
            <a onclick="gui.editProjectDescription();" class="button">edit description</a>
        </div>
    
    </div>

    <div id="projectdescription" class="panel" style="padding:0px;">




    <div class="panel" style="padding:0px;">
        <div class="panelhead">export</div>
        <div>
            <a onclick="gui.patch().exportStatic();" class="button">export static archive</a>
        </div>

    </div>



    <div class="panel" style="padding:0px;">
        <div class="panelhead">debug</div>
        <div>

            <!-- <a onclick="gui.patch().saveCurrentProject();" class="button">save settings</a> -->
            <h3>debug</h3>
            numOps:{{debug.numOps}}
            <br/>
            numSvgElements:{{debug.numSvgElements}}
            <br/>
            numVisibleOps:{{debug.numVisibleOps}}
            <br/>
            <br/>
            <br/>
            <br/>
            {{project.id}}
            <a class="button fa fa-trash-o tt" data-tt="delete" onclick="gui.deleteCurrentProject();">&nbsp;delete project</a>



            <br/><br/>
            <a class="button " onclick="gui.scene().clear();">&nbsp;clear patch</a>

            <br/>
            <br/><br/>
            <a class="button " onclick="localStorage['cables']=gui.scene().serialize();">&nbsp;load from local storage</a>
            <br/><br/>

            <a class="button " onclick="gui.scene().clear();self.scene().deSerialize(localStorage['cables']);">&nbsp;save to local storage</a>
            <br/><br/><br/>



            <a class="button " onclick="gui.exportDialog();">export</a>
            <a class="button " onclick="gui.importDialog();">import</a>
            <br/><br/>


        </div>

    </div>



        


    </div>


<script>

function updateIcons()
{
    if($('#projectsettings_public').val()=='true')
    {
        $('#projectsettings_public_icon').addClass('fa-check-square-o');
        $('#projectsettings_public_icon').removeClass('fa-square-o');
    }
    else
    {
        $('#projectsettings_public_icon').removeClass('fa-check-square-o');
        $('#projectsettings_public_icon').addClass('fa-square-o');
    }
    
}

function togglePublic()
{
    $('#projectsettings_public').val(''+!($('#projectsettings_public').val()=='true')); 

    updateIcons();
    gui.patch().saveProjectParams();

}

updateIcons();



</script>


</script>


<script id="tmpl_projectfiles_list" type="text/x-handlebars-template">
    <h2>files</h2>

    <table class="list">
        {{#each files}}
            <tr>
            <!--
            <td>
                <a class="button fa fa-info-circle" onclick="gui.patch().showFileInfo*()"></a> 
            </td>-->
            <td>
                <a class="filename" onclick="gui.patch().addAssetOp('{{p}}','{{suffix}}','{{name}}')">
                {{name}}
                </a>
                
                {{#compare suffix '==' '.json' }}<br/><a class="button" onclick="gui.importJson3D('{{_id}}')">create scene ops</a>{{/compare}}
            </td>
            <td>

                <a class="button fa fa-trash-o" onclick="CABLES.api.delete('project/{{projectId}}/file/{{_id}}',null,function(){gui.patch().updateProjectFiles();});"></a>&nbsp;

                <!-- <a class="button fa fa-retweet"></a> -->
            </td>
            </tr>
        {{/each}}
    </table>
</script>


<script id="tmpl_projectfiles_upload" type="text/x-handlebars-template">
    <br/>
    <a class="fa fa-upload"></a>
    drag & drop files to browser window to upload...
</script>





<script id="select_project" type="text/x-handlebars-template">

<style>

.thumbcont .title
{
    background-color:#222;
    padding:10px;

}

.searchresult
{
    width:180px;
    height:130px;
    float:left;
    cursor:pointer;
}

.thumbcont
{
    border:none !important;
}

.searchresult img
{
    max-width:180px;
    max-height:100px;
}

</style>

    
<div class="opsearch" style="height:auto;">
    <h2>load project</h2>

    <input id="projectsearch"/>

    <br/><br/>
    <style id="search_style"></style>


    <div style="height:600px;overflow:auto">
      {{#each projects}}


        <div class="thumbcont searchresult searchable" data-projid="{{ _id }}" data-index="{{name}}" onclick="document.location.href='#/project/{{_id}}'">
            <div style="background-color:black;width:180px;height:100px;background-image:url(/api/project/{{_id}}/screenshot);background-repeat:no-repeat;background-size:100%;background-position:center center;"></div>
            <div class="title">
                {{name}}
            </div>
        </div>

      {{/each}}
    </div>

</div>

</script>



<script id="timeline_controler" type="text/x-handlebars-template">

    <div id="timelineui">
        <a id="button_toggleTiming" class="button">timing</a>

        <span class="timelinetime" onclick="gui.timeLine().toggleTimeDisplayMode();"></span>

        <a class="button fa fa-step-backward" onclick="gui.timeLine().gotoZero();"></a>
        <a class="button fa fa-backward" onclick="gui.timeLine().gotoOffset(-2);"></a>
        <a class="button fa fa-play " id="timelineplay" onclick="gui.timeLine().togglePlay()"></a>
        <a class="button fa fa-forward" onclick="gui.timeLine().gotoOffset(2);"></a>
        

        <div id="keycontrols">
            <span class="button timeLineInsert fa fa-plus-square-o"></span>

            <input type ="range" min="20" max="2000" value="" step ="1" oninput="gui.timeLine().setTimeScale(this.value);" style="float:left;width:85px;margin-left:20px;margin-top:10px;" class="tt" data-tt="scale time display"/>


            <a id="keymovemode" class="button fa fa-arrows-h tt" data-tt="key move mode" ></a>
            <a id="keyscaleheight" class="button fa fa-ellipsis-v tt" data-tt="scale value display"></a>
            <a id="keyscalewidth" class="button fa fa-ellipsis-h tt" data-tt="show all keys"></a>
            <a id="centercursor" class="button fa fa-i-cursor tt" data-tt="scroll to cursor"></a>
            <a id="loop" class="button fa fa-retweet tt" data-tt="toggle loop"></a>
            <a id="toggleMultiGraphKeyDisplay" class="button fa fa-line-chart tt" data-tt="toggle key display of multiple graphs / right click - remove all graphs"></a>


            <a onclick="$('.easingselect').toggle();" class="button">ease</a>
        </div>

    </div>

    <div id="timelineTitle" ></div>
    <div id="timetimeline" ></div>
    <div id="timeline" tabindex="2"></div>





</script>


        <a id="undev" target="_blank" href="http://www.undev.de"></a>

    </body>
</html>
