
<script id="filemanager_header" type="text/x-handlebars-template">

    <div class="filemanager_header">

        <span class="divider"></span>

        <a class="fileManagerSource {{#compare source '==' 'patch' }}activeFileManagerSource{{/compare}}" onclick="gui.fileManager.setSource('patch');" class="info" data-info="file_source_patch">Patch Files</a>
        <a class="fileManagerSource {{#compare source '==' 'patch' }}{{else}}activeFileManagerSource{{/compare}}" onclick="gui.fileManager.setSource('lib');" class="info" data-info="file_source_lib">Library Files</a>

        <span class="divider"></span>

        <span class="iconbutton info" data-info="file_refresh" onclick="gui.refreshFileManager();" >
            <i class="icon icon-refresh"></i>
        </span>

        <span class="iconbutton info" data-info="file_upload" onclick="CABLES.CMD.PATCH.uploadFileDialog();" >
            <i class="icon icon-upload"></i>
        </span>
        
        <span class="iconbutton info" data-info="file_create" onclick="CABLES.CMD.PATCH.createFile();" >
            <i class="icon icon-file-plus"></i>
        </span>
        
        {{#compare source '==' 'patch' }}

        <!-- / sort [type][data][size][name] -->
        <!-- / display [icons][list] -->


        {{/compare}}

        <span class="divider"></span>


        <span id="switch-display-icons" class="switch switch-left {{#compare display '==' 'icons' }}switch-active{{/compare}}">
            <i class="icon icon-grid"></i>
        </span>
        <span id="switch-display-list" class="switch switch-right {{#compare display '==' 'list' }}switch-active{{/compare}}">
            <i class="icon icon-menu"></i>
        </span>

        {{#if fileSelectOp}}
            <span style="border:2px solid var(--color-special);padding:7px;border-radius:10px;cursor:pointer;" onclick="gui.fileManager.setFilePort(null);">
                Selection mode for: {{fileSelectOp.objName}} 
                <span class="icon icon-x"></span>
            </span>
        {{/if}}

    </div>
</script>




<script id="tab_itemmanager" type="text/x-handlebars-template">
    <div id="filemanagercontainer" style="height:99%">

        <div id="itemmanager_header" style="width:100%;height:50px;"></div>

        <div class="filelistcontainer">
            {{#each items}}
                {{#if divider}}
                    <div style="clear:both"></div>
                    <div style="border-bottom:1px solid var(--color-07);margin-bottom:5px;" class="text-center">
                        <h1>{{divider}}</h1>
                    </div>
                {{else}}
                    <div class="info item item-container {{#if selected}} selected {{/if}} draggable" id="item{{id}}" draggable="true" ondragstart="CABLES.DragNDrop.startDragLibraryFile(event,'{{p}}');" data-info="Drag this File to the patchfield to create op!">
                        <div>
                            {{#if preview}}
                            <div class="preview" style="width:90%;height:calc(90% - 22px);;background-color:#777;background-image:url(img/checkerboard.png);background-size:40%;background-repeat:repeat;">
                                <div style="background-image:url({{preview}}?rnd={{file.cachebuster}});width:100%;height:100%;background-size:contain;background-repeat:no-repeat;background-position:center center;">
                                </div>
                            </div>
                            {{else}}
                            <div class="preview text-center" style="width:90%;height:calc(90% - 22px);;background-color:#555;" >
                                <br/>
                                <span class="icon icon-{{icon}} icon-4x"></span>
                            </div>
                            {{/if}}
                        </div>
                        <div class="filename">{{title}}</div>
                    </div>
                {{/if}}
            {{/each}}
            <div style="clear:both"></div>
        </div>

        <div id="item_details"></div>
    </div>
</script>


<script id="tab_itemmanager_list" type="text/x-handlebars-template">

    <div id="itemmanager_header" style="width:100%;height:50px;"></div>

    <div class="filelistcontainer">
        <table class="table">
            <tr>
                <th onclick="gui.fileManager.setOrder('type');" style="cursor:pointer;"><span class="icon icon-file"></span></th>
                <th onclick="gui.fileManager.setOrder('name');" style="cursor:pointer;">Filename</th>
                <th onclick="gui.fileManager.setOrder('size');" style="cursor:pointer;">Size</th>
                <th onclick="gui.fileManager.setOrder('date');" style="cursor:pointer;">Changed</th>
            </tr>
            {{#each items}}
                {{#if divider}}
                    <tr>
                        <td colspan="100">
                            <div style="border-bottom:1px solid var(--color-07);margin-bottom:5px;" class="text-center">
                                <h1>{{divider}}</h1>
                            </div>
                        </td>
                    </tr>
                {{else}}
                    <tr>
                        <td><span class="icon icon-{{icon}} "></span></td>
                        <td><div id="item{{id}}" draggable="true" ondragstart="CABLES.DragNDrop.startDragLibraryFile(event,'{{p}}');" class="draggable listitem item {{#if selected}} selected {{/if}}" >{{title}}</div></td>
                        <td>{{sizeKb}}</td>
                        <td>{{dateFromNow}}</td>
                    </tr>
                {{/if}}
            {{/each}}
        </table>
    </div>
    <div id="item_details"></div>


</script>











<script id="filemanager_details" type="text/x-handlebars-template">

    <div class="filemanager-detail-element">

        {{#if file.imgPreview}}
            <img src="/assets/{{file.fileDb.projectId}}/{{file.fileDb.fileName}}?rnd={{file.cachebuster}}" style="height:auto;max-width:100%;"/>
        {{else}}
            No preview!!
        {{/if}}

    </div>
    <div class="filemanager-detail-element">
        <div style="padding:10px;">

            <a class="iconbutton info" data-tt="download file" data-infotext="file_download" download href="/assets/{{file.fileDb.projectId}}/{{file.fileDb.fileName}}?rnd={{file.cachebuster}}">
                <span class="tt icon icon-1x icon-download" ></span>
            </a>
            <a class="iconbutton info" data-tt="open in new window" data-infotext="file_open" target="_blank" href="/assets/{{file.fileDb.projectId}}/{{file.fileDb.fileName}}?rnd={{file.cachebuster}}">
                <span class="tt icon icon-1x icon-external"></span>
            </a>
            <span class="iconbutton info" data-tt="search in patch" data-infotext="file_search" onclick="gui.find().show('{{file.fileDb.fileName}}')">
                <a class="tt icon icon-1x icon-search"></a>
            </span>

            {{#compare source '==' 'patch' }}
            <span class="iconbutton info" data-tt="delete file" id="filedelete{{file.fileDb._id}}" data-infotext="file_delete">
                <a class="tt icon icon-1x icon-trash" ></a>
            </span>
            {{/compare}}
                
            <!-- &nbsp;&nbsp;<a class="tt icon icon-1x icon-editbox" data-tt="edit file" data-infotext="file_edit"></a> -->
            <br/><br/>

            <b>{{file.fileDb.fileName}}</b>
            
            {{#compare source '==' 'patch' }}
                <br/><br/>
                {{#if file.imgSizeWidth}}
                        {{file.fileDb.type}}: {{ file.imgSizeWidth }} x {{ file.imgSizeHeight }} ({{file.sizeReadable}})
                    {{else}}
                        {{file.fileDb.type}} ({{file.sizeReadable}})
                {{/if}}

                <br/><br/>
                last change: {{file.readableDateSince}}<br/>
                {{file.readableDate}}
                <br/><br/>
            {{/compare}}

        </div>
    </div>
    <div class="filemanager-detail-element">
        {{#if file.ops}}
            File Ops
            <br/><br/>
            {{#each file.ops}}
                <a class="button fa fa-plus-circle" onclick="gui.patch().addAssetOp('{{op}}','{{portname}}','{{../file.fileDb.fileName}}','{{title}}')">&nbsp;add <b>{{op}}</b></a>
                <br/><br/>
            {{/each}}
        {{/if}}

        {{#if file.converters}}
            File Tools
            <br/><br/>
            {{#each file.converters}}
                <a class="button fa fa-retweet" onclick="gui.showConverter('{{ id }}','{{ ../file.fileDb.projectId }}','{{ ../file.fileDb._id }}','{{ name }}');">&nbsp;{{ name }}</a>
                <br/>
            {{/each}}
        {{/if}}
    </div>
    <div style="clear:both;"></div>



</script>
